{"version":3,"sources":["state/actions/userToken.tsx","state/actions/profile.tsx","state/actions/manifest.tsx","state/globalContextState.tsx","constants.tsx","api/bungieApi.tsx","hooks/useGlobalState.tsx","util/inventoryUtil.tsx","util/presetUtil.tsx","components/ItemDisplay/ItemDisplay.tsx","components/ErrorBoundary/ErrorBoundary.tsx","App.tsx","components/Pages/LoadoutOptimizerPage/LoadoutOptimizerPage.tsx","components/Auth/Auth.tsx","components/Pages/Homepage/Homepage.tsx","components/Pages/OAuthCallbackPage/OAuthCallbackPage.tsx","hooks/useAppReducer.tsx","serviceWorker.js","index.js"],"names":["setUserAuth","accessToken","expiresIn","membershipId","membershipType","state","name","Date","now","window","localStorage","setItem","JSON","stringify","cachedUserAuth","parse","getItem","setProfile","data","setManifest","contentPath","version","setComponentContent","defaultState","reduce","obj","action","Error","AppStateContext","createContext","API_TOKEN","API_ROOT_PATH","bungieRequestHeaders","userAuth","location","href","Authorization","useGlobalState","useContext","MOD_BASELINE_CONFIG","shouldAddItem","exoticItem","item","itemHash","exotic","content","itemTypeDisplayName","hash","getInventoryContent","profile","contentMap","vaultInventory","profileInventory","items","characterInventories","Object","keys","map","key","stats","itemComponents","instanceData","instances","modSlots","sockets","filter","itemInstanceId","equippingBlock","quality","uniqueLabel","classType","powerCap","powercaps","versions","powerCapHash","intellect","value","mobility","strength","discipline","recovery","resilience","mods","appliedMods","length","forEach","prop","some","socket","isEnabled","plugHash","toString","isModEquipped","extraItemData","energy","energyCapacity","stat","applyBaseLineStats","getStatBuild","combo","o","a","total","presetPvPStandard","totalFloor","n","presetPvPPerfect","presetPvEStandard","presetPvEPerfect","presetPvPLowResilience","width","ItemDisplay","mode","isPvP","indexOf","totalStats","className","css","padEnd","statName","bonus","index","statItems","statString","b","substr","join","displayProperties","ErrorBoundary","hasError","error","info","console","debug","this","props","defaultErrorMessage","children","Component","authRoutes","dispatch","useState","isLoading","setIsLoading","setMode","mainClass","setMainClass","setExotic","useEffect","manifest","Promise","all","axios","url","params","components","headers","then","Response","jsonWorldComponentContentPaths","en","DestinyRecordDefinition","DestinyInventoryItemLiteDefinition","DestinyPowerCapDefinition","res","powerCapRes","onModeChange","useCallback","e","target","onMainClassChange","onExotic","inventoryData","useMemo","componentContent","categorizedItems","helmets","gauntlets","chests","legs","push","filterAndCategorize","i","exotics","uniqBy","combos","preset","helmet","gauntlet","chest","leg","set","sort","style","padding","label","options","onChange","x","Cmp","path","component","to","routes","history","useHistory","query","qs","search","code","method","grant_type","client_id","route","getAuthToken","auth","access_token","expires_in","log","membershipRes","destinyMemberships","exact","App","useReducer","Provider","Boolean","hostname","match","ReactDOM","render","StrictMode","document","getElementById","navigator","serviceWorker","ready","registration","unregister","catch","message"],"mappings":"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","file":"static/js/main.4e1c791b.chunk.js","sourcesContent":["export interface IUserAuth {\n  name : string,\n  accessToken : string,\n  membershipId : string;\n  membershipType : string;\n  expiresIn : number;\n}\n\nexport default function setUserAuth(\n  accessToken = '',\n  expiresIn = 0,\n  membershipId = '',\n  membershipType = ''\n) : IUserAuth {\n  const state = {\n    name: 'userAuth',\n    accessToken: accessToken,\n    membershipId: membershipId,\n    expiresIn: Date.now() + (expiresIn * 1000),\n    membershipType : membershipType\n  };\n\n  if (accessToken) {\n    window.localStorage.setItem('userAuth', JSON.stringify(state));\n  }\n\n  // if no arguments provided, recall cached token\n  if (!accessToken) {\n    const cachedUserAuth = JSON.parse(window.localStorage.getItem('userAuth') || '{}');\n\n    return {\n      ...state,\n      ...cachedUserAuth\n    };\n  }\n\n  return state;\n}\n","export interface IManifest {\n  data : any\n  name : string;\n}\n\nexport function setProfile(data ?: any) : IManifest {\n  return {\n    name: 'profile',\n    ...data\n  };\n}\n","export interface IManifest {\n  contentPath : string;\n  version : string;\n  name : string;\n}\n\nexport function setManifest(data = {contentPath: '', version: ''}) : IManifest {\n  return {\n    name: 'manifest',\n    ...data\n  };\n}\n\nexport function setComponentContent(data : any) {\n  return {\n    name: 'componentContent',\n    ...data\n  }\n}\n","import {createContext} from 'react';\nimport setUserAuth from './actions/userToken';\nimport {setProfile} from './actions/profile';\nimport {setComponentContent, setManifest} from './actions/manifest';\n\nexport type TActionResponse = {name : string, [key : string] : any};\nexport type TAction = (...args : any[]) => TActionResponse;\n\n// register all actions here\nexport const actionList : TAction[] = [\n  setUserAuth,\n  setProfile,\n  setManifest,\n  setComponentContent\n];\n\nexport const defaultState = actionList.reduce((obj, action) => {\n  const {name, ...state} = action();\n\n  // validate key\n  if (!name) {\n    throw new Error('action must return a `type` value');\n  }\n\n  return {\n    ...obj,\n    // invoke default state\n    [name]: state\n  }\n}, {});\n\nexport const AppStateContext = createContext(defaultState);\n","export const API_TOKEN = 'f5a851a085ec464e8c1af199031b6aec';\nexport const API_CLIENT_ID = '3770';\nexport const API_ROOT_PATH = 'https://www.bungie.net/platform';\nexport const AUTH_URL = `https://www.bungie.net/en/OAuth/Authorize?client_id=${API_CLIENT_ID}&response_type=code`;\nexport const CLASS_TYPE_HUNTER = 1;\nexport const CLASS_TYPE_WARLOCK = 2;\nexport const CLASS_TYPE_TITAN = 0;\nexport const STAT_TYPE_INTELLECT = \"144602215\";\nexport const STAT_TYPE_MOBILITY = \"2996146975\";\nexport const STAT_TYPE_STRENGTH = \"4244567218\";\nexport const STAT_TYPE_DISCIPLINE = \"1735777505\";\nexport const STAT_TYPE_RECOVERY = \"1943323491\";\nexport const STAT_TYPE_RESILIENCE = \"392767087\";\n\nexport const MOD_TYPE_MOBILITY = \"3961599962\";\nexport const MOD_TYPE_MOBILITY2 = \"275671171\";\nexport const MOD_TYPE_RECOVERY = \"2645858828\";\nexport const MOD_TYPE_RECOVERY2 = \"126924337\";\nexport const MOD_TYPE_RESILIENCE = \"3790655795\";\nexport const MOD_TYPE_RESILIENCE2 = \"2850583378\";\nexport const MOD_TYPE_STRENGTH = \"3253038666\";\nexport const MOD_TYPE_INTELLECT = \"3355995799\"\nexport const MOD_TYPE_DISCIPLINE = \"4048838440\";\n\nexport const MOD_TYPE_TRACTION = \"1708067044\";\nexport const MOD_TYPE_TRACTION2 = \"1818103563\";\nexport const MOD_TYPE_RADIANT_LIGHT = \"2979815167\";\nexport const MOD_TYPE_POWERFUL_FRIENDS = \"1484685887\";\n\nexport const MOD_TYPE_STACK_ON_STACKS = \"3523075123\";\nexport const MOD_TYPE_PRECISELY_CHARGED = \"3523075122\";\nexport const MOD_TYPE_PROTECTIVE_LIGHT = \"3523075120\";\nexport const MOD_TYPE_EXTRA_RESERVES = \"3523075121\";\nexport const MOD_TYPE_SURPRISE_ATTACK = \"2263321585\";\n","import axios from 'axios';\nimport qs from 'query-string';\nimport {API_CLIENT_ID, API_ROOT_PATH, API_TOKEN, AUTH_URL} from '../constants';\nimport {IUserAuth} from '../state/actions/userToken';\n\nexport function httpBungie(route : string) {\n  return API_ROOT_PATH + route;\n}\n\nexport function bungieRequestHeaders(userAuth ?: IUserAuth) {\n  if (userAuth) {\n    const isTokenStale = userAuth.accessToken ? (Date.now() > userAuth.expiresIn) : true;\n\n    // immediately redirect if the token is stale\n    if (isTokenStale) {\n      window.location.href = '/d2io';\n    }\n\n    return {\n      'x-api-key': API_TOKEN,\n      Authorization: `Bearer ${userAuth.accessToken}`\n    };\n  }\n\n  return {\n    'x-api-key': API_TOKEN\n  };\n}\n\nexport function getAuthToken(code : string) {\n  return axios({\n    method: 'POST',\n    headers: {\n      ...bungieRequestHeaders(),\n      'content-type': 'application/x-www-form-urlencoded'\n    },\n    data: qs.stringify({\n      code,\n      grant_type: 'authorization_code',\n      client_id: API_CLIENT_ID\n    }),\n    url: httpBungie('/app/oauth/token/')\n  });\n}\n\nexport function getMembershipsForCurrentUser(userAuth : IUserAuth) {\n  return axios({\n    url: `${API_ROOT_PATH}/User/GetMembershipsForCurrentUser/`,\n    headers: bungieRequestHeaders(userAuth)\n  });\n}\n\nexport function getProfile(userAuth : IUserAuth) {\n  return axios({\n    url: `https://www.bungie.net/Platform/Destiny2/${userAuth.membershipType}/Profile/${userAuth.membershipId}/`,\n    params: {\n      components: '100,102,103,200,201,202,205,300,301,304,305,306,307,800,308,310,309,900,1100'\n    },\n    headers: bungieRequestHeaders(userAuth)\n  });\n}\n\nexport function getManifest() {\n  return axios({\n    url: `${API_ROOT_PATH}/Destiny2/Manifest/`,\n    headers: bungieRequestHeaders()\n  });\n}\n\n","import {useContext} from 'react';\nimport {AppStateContext} from '../state/globalContextState';\n\nexport function useGlobalState() {\n  return useContext(AppStateContext) as any;\n}\n","import {\n  MOD_TYPE_DISCIPLINE, MOD_TYPE_EXTRA_RESERVES,\n  MOD_TYPE_INTELLECT,\n  MOD_TYPE_MOBILITY, MOD_TYPE_MOBILITY2,\n  MOD_TYPE_POWERFUL_FRIENDS,\n  MOD_TYPE_PRECISELY_CHARGED,\n  MOD_TYPE_PROTECTIVE_LIGHT,\n  MOD_TYPE_RADIANT_LIGHT,\n  MOD_TYPE_RECOVERY, MOD_TYPE_RECOVERY2,\n  MOD_TYPE_RESILIENCE, MOD_TYPE_RESILIENCE2,\n  MOD_TYPE_STACK_ON_STACKS,\n  MOD_TYPE_STRENGTH, MOD_TYPE_SURPRISE_ATTACK,\n  MOD_TYPE_TRACTION, MOD_TYPE_TRACTION2,\n  STAT_TYPE_DISCIPLINE,\n  STAT_TYPE_INTELLECT,\n  STAT_TYPE_MOBILITY,\n  STAT_TYPE_RECOVERY,\n  STAT_TYPE_RESILIENCE,\n  STAT_TYPE_STRENGTH\n} from '../constants';\n\nexport interface Item {\n\n}\n\nexport const MOD_BASELINE_CONFIG = [\n  [MOD_TYPE_MOBILITY, 'mobility', -10],\n  [MOD_TYPE_MOBILITY2, 'mobility', -10],\n  [MOD_TYPE_RECOVERY, 'recovery', -10],\n  [MOD_TYPE_RECOVERY2, 'recovery', -10],\n  [MOD_TYPE_RESILIENCE, 'resilience', -10],\n  [MOD_TYPE_RESILIENCE2, 'resilience', -10],\n  [MOD_TYPE_STRENGTH, 'strength', -10],\n  [MOD_TYPE_INTELLECT, 'intellect', -10],\n  [MOD_TYPE_DISCIPLINE, 'discipline', -10],\n  [MOD_TYPE_TRACTION, 'mobility', -5],\n  [MOD_TYPE_TRACTION2, 'mobility', -5],\n  [MOD_TYPE_RADIANT_LIGHT, 'strength', -20],\n  [MOD_TYPE_POWERFUL_FRIENDS, 'mobility', -20],\n  [MOD_TYPE_STACK_ON_STACKS, 'recovery', 10],\n  [MOD_TYPE_PRECISELY_CHARGED, 'discipline', 10],\n  [MOD_TYPE_PROTECTIVE_LIGHT, 'strength', 10],\n  [MOD_TYPE_EXTRA_RESERVES, 'intellect', 10],\n  [MOD_TYPE_SURPRISE_ATTACK, 'intellect', 10]\n]\n\nexport function isModEquipped(hash : any, sockets : any) {\n  return sockets.some((socket : any) => socket.isEnabled && socket.plugHash.toString() === hash.toString());\n}\n\nexport function applyBaseLineStats(item : any, mods : any, instanceData : any) {\n  const appliedMods = mods[item.itemInstanceId];\n\n  // do nothing if there's no mods to work wit\n  if (!appliedMods || appliedMods.sockets.length === 0) {\n    return item;\n  }\n\n  MOD_BASELINE_CONFIG.forEach(([hash, prop, value]) => {\n    if (isModEquipped(hash, appliedMods.sockets)) {\n      item[prop] += value;\n    }\n  });\n\n  // check for master worked items\n  const extraItemData = instanceData[item.itemInstanceId];\n  if (extraItemData && extraItemData.energy && extraItemData.energy.energyCapacity === 10) {\n    [\n      'mobility',\n      'recovery',\n      'resilience',\n      'strength',\n      'intellect',\n      'discipline'\n    ].forEach((stat) => {\n      item[stat] -= 2;\n    });\n  }\n\n  return item;\n}\n\nfunction shouldAddItem(exoticItem : any, item : any) {\n  // must be an exotic and a constant must be set (no constant leads to multi-exotic load outs)\n  // if a constant exists, non exotics of this type must be omitted\n  if (exoticItem.itemHash && item.exotic) {\n    if (item.itemHash === exoticItem.itemHash) {\n      return true;\n    }\n\n    return false;\n  }\n\n  // filter anything that is taking up the same exotic slot\n  if (exoticItem.itemHash && !item.exotic && exoticItem.content.itemTypeDisplayName === item.content.itemTypeDisplayName) {\n    return false;\n  }\n\n  // if no hash is defined, exclude exotics from the pool\n  if (!exoticItem.hash && item.exotic) {\n    return false;\n  }\n\n  return true;\n}\n\nexport function filterAndCategorize({powerCap, exoticItem, items, mainClass} : any) {\n  const helmets : any = [];\n  const gauntlets : any = [];\n  const chests : any = [];\n  const legs : any = [];\n\n  if (items.length === 0) {\n    return {helmets, gauntlets, chests, legs};\n  }\n\n  if (mainClass === '') {\n    return {helmets, gauntlets, chests, legs};\n  }\n\n  items\n    // filter by powercap\n    .filter((item : any) => item.powerCap >= powerCap)\n    // filter by class\n    .filter((item : any) => item.classType.toString() === mainClass.toString())\n    // map each item\n    .forEach((item : any) => {\n      switch (item.content.itemTypeDisplayName) {\n        case 'Helmet':\n          // eslint-disable-next-line @typescript-eslint/no-unused-expressions\n          shouldAddItem(exoticItem, item) ? helmets.push(item) : null;\n          break;\n        case 'Gauntlets':\n          // eslint-disable-next-line @typescript-eslint/no-unused-expressions\n          shouldAddItem(exoticItem, item) ? gauntlets.push(item) : null;\n          break;\n        case 'Chest Armor':\n          // eslint-disable-next-line @typescript-eslint/no-unused-expressions\n          shouldAddItem(exoticItem, item) ? chests.push(item) : null;\n          break;\n        case 'Leg Armor':\n          // eslint-disable-next-line @typescript-eslint/no-unused-expressions\n          shouldAddItem(exoticItem, item) ? legs.push(item) : null;\n          break;\n      }\n    });\n\n  return {helmets, gauntlets, chests, legs};\n}\n\nexport function getInventoryContent(profile : any, contentMap : any) {\n  const vaultInventory = profile.profileInventory.data.items;\n  const characterInventories = Object.keys(profile.characterInventories.data)\n    .map(key => profile.characterInventories.data[key].items);\n\n  const stats = profile.itemComponents.stats.data;\n  const instanceData = profile.itemComponents.instances.data;\n  const modSlots = profile.itemComponents.sockets.data;\n\n  const items = [\n    ...vaultInventory,\n    ...characterInventories\n  ];\n\n  return items\n    .filter(item => (\n      item.itemInstanceId\n      && contentMap[item.itemHash].equippingBlock\n      && contentMap[item.itemHash].quality\n      // must have an armor stat\n      && stats[item.itemInstanceId].stats[STAT_TYPE_INTELLECT]\n    ))\n    .map(item => ({\n      ...item,\n      content: contentMap[item.itemHash],\n      exotic: contentMap[item.itemHash].equippingBlock.uniqueLabel === 'exotic_armor',\n      classType: contentMap[item.itemHash].classType,\n      powerCap: contentMap.powercaps[contentMap[item.itemHash].quality.versions[0].powerCapHash].powerCap,\n      intellect: stats[item.itemInstanceId].stats[STAT_TYPE_INTELLECT].value,\n      mobility: stats[item.itemInstanceId].stats[STAT_TYPE_MOBILITY].value,\n      strength: stats[item.itemInstanceId].stats[STAT_TYPE_STRENGTH].value,\n      discipline: stats[item.itemInstanceId].stats[STAT_TYPE_DISCIPLINE].value,\n      recovery: stats[item.itemInstanceId].stats[STAT_TYPE_RECOVERY].value,\n      resilience: stats[item.itemInstanceId].stats[STAT_TYPE_RESILIENCE].value\n    }))\n    .map(item => applyBaseLineStats(item, modSlots, instanceData))\n}\n","export function getStatBuild(items : any[]) {\n  const combo = items;\n  const mobility = combo.reduce((o, a) => o + a.mobility, 0);\n  const resilience = combo.reduce((o, a) => o + a.resilience, 0);\n  const recovery = combo.reduce((o, a) => o + a.recovery, 0);\n  const discipline = combo.reduce((o, a) => o + a.discipline, 0);\n  const intellect = combo.reduce((o, a) => o + a.intellect, 0);\n  const strength = combo.reduce((o, a) => o + a.strength, 0);\n  const total = mobility + resilience + recovery + discipline + intellect + strength;\n\n  return {\n    mobility,\n    resilience,\n    recovery,\n    discipline,\n    intellect,\n    strength,\n    total\n  };\n}\n\nexport function presetPvPStandard(items : any[], totalFloor = 220) {\n  const {\n    mobility,\n    recovery,\n    discipline,\n    intellect,\n    strength,\n    total\n  } = getStatBuild(items);\n\n  return (\n    mobility <= 59\n    && recovery >= 60\n    // traction\n    && (mobility % 10) >= 5\n    // must all be moderate levels of stats\n    && [\n      (recovery % 10) <= 4,\n      (intellect % 10) <= 4,\n      (discipline % 10) <= 4,\n      (strength % 10) <= 4\n    ].filter(n => n).length >= 4\n\n    && total >= totalFloor\n  );\n}\n\nexport function presetPvPPerfect(items : any[], totalFloor = 220) {\n  const {\n    mobility,\n    recovery,\n    discipline,\n    intellect,\n    strength,\n    resilience\n  } = getStatBuild(items);\n\n  return (\n    mobility <= 59\n    && recovery >= 60\n    // traction\n    && (mobility % 10) >= 5\n    && resilience <= 30\n    // must all be moderate levels of stats\n    && [\n      (resilience % 10) <= 2,\n      (recovery % 10) <= 2,\n      (intellect % 10) <= 2,\n      (discipline % 10) <= 2,\n      (strength % 10) <= 2\n    ].filter(n => n).length >= 5\n  );\n}\n\nexport function presetPvEStandard(items : any[], totalFloor = 220) {\n  const {\n    mobility,\n    recovery,\n    discipline,\n    intellect,\n    strength,\n    total\n  } = getStatBuild(items);\n\n  return (\n    (recovery >= 60)\n    && (discipline >= 50)\n    && [\n      (mobility % 10) <= 4,\n      (recovery % 10) <= 4,\n      (intellect % 10) <= 4,\n      (discipline % 10) <= 4,\n      (strength % 10) <= 4\n    ].filter(n => n).length >= 5\n\n    && total >= totalFloor\n  );\n}\n\nexport function presetPvEPerfect(items : any[], totalFloor = 220) {\n  const {\n    mobility,\n    recovery,\n    discipline,\n    intellect,\n    strength,\n    resilience\n  } = getStatBuild(items);\n\n  return (\n    (recovery >= 60)\n    && (discipline >= 50)\n    && [\n      (mobility % 10) <= 2,\n      (recovery % 10) <= 2,\n      (intellect % 10) <= 2,\n      (discipline % 10) <= 2,\n      (strength % 10) <= 2,\n      (resilience % 10) <= 2\n    ].filter(n => n).length >= 6\n  );\n}\n\n\nexport function presetPvPLowResilience(items : any[], totalFloor = 220) {\n  const {\n    resilience\n  } = getStatBuild(items);\n\n  return (\n    resilience < 30\n  );\n}\n","import React from 'react';\nimport {css} from 'react-emotion';\nimport {getStatBuild} from '../../util/presetUtil';\n\nconst divider = '---------------------------------------------------';\nconst width = divider.length;\n\nexport default function ItemDisplay({items, stats, mode} : any) {\n  const {\n    mobility,\n    recovery,\n    discipline,\n    intellect,\n    strength,\n    resilience,\n    total\n  } = stats;\n\n  const isPvP = mode.indexOf('PvP') >= 0;\n\n  const totalStats = [\n    ['Mobility', mobility, isPvP ? 35 : 10],\n    ['Resilience', resilience, 10],\n    ['Recovery', recovery, 10],\n    ['Discipline', discipline, 10],\n    ['Intellect', intellect, 10],\n    ['Strength', strength, isPvP ? 30 : 10],\n  ];\n\n\n  return (\n    <pre\n      className={css`\n        font-family: monospace;\n        color: #fff;\n        background: #000;\n        width: 500px;\n        padding: 10px;\n      `}\n    >\n\n      {`| ${'Stat Total'.padEnd(13, '.')}${total} (max: 280)`.padEnd(width - 1) + '|'}\n      <br />\n      {totalStats.map(([statName, stat, bonus]) => (\n        <div key={statName}>\n          {`| ${statName.padEnd(13, '.')}${stat} (${stat+bonus})`.padEnd(width - 1) + '|'}\n        </div>\n      ))}\n      {`| `.padEnd(width - 1) + '|'}\n      <br />\n      {items.map((item : any, index : any) => {\n        const statItems = [\n          ['Mobility', item.mobility],\n          ['Resilience', item.resilience],\n          ['Recovery', item.recovery],\n          ['Discipline', item.discipline],\n          ['Intellect', item.intellect],\n          ['Strength', item.strength],\n        ];\n\n        const total = statItems.reduce((o : any, a : any) => o + a[1], 0);\n        const statString = statItems.map(([a, b] : any) => `${a.substr(0, 3)} ${b}`).join('  ');\n\n        return (\n          <div key={index}>\n            {`| [${item.content.itemTypeDisplayName}] ${item.content.displayProperties.name} (${total})`.padEnd(width - 1) + '|'}\n            <br />\n            {`| ${statString}`.padEnd(width - 1) + '|'}\n          </div>\n        );\n      })}\n    </pre>\n  )\n}\n","import React, {Component, ErrorInfo, ReactNode} from 'react';\n\nexport interface IErrorBoundaryProps {\n  children : ReactNode;\n  defaultErrorMessage ?: string;\n}\n\nexport default class ErrorBoundary extends Component<IErrorBoundaryProps> {\n  state = {\n    hasError: false\n  };\n\n  static getDerivedStateFromError(error : Error) {\n    // Update state so the next render will show the fallback UI.\n    return {hasError: true};\n  }\n\n  componentDidCatch(error : Error, info : ErrorInfo) {\n    // eslint-disable-next-line no-console\n    console.debug('caught error within ErrorBoundary');\n    // eslint-disable-next-line no-console\n    console.error(error, info);\n    // @TODO add client side error logging here\n  }\n\n  render() {\n    return !this.state.hasError ? (\n      this.props.children\n    ) : (\n      <div>\n        {this.props.defaultErrorMessage || 'An error has occurred on this page.'}\n      </div>\n    );\n  }\n}\n","import React, {ComponentType, ReactNode} from 'react';\nimport '@blueprintjs/icons/lib/css/blueprint-icons.css';\nimport '@blueprintjs/core/lib/css/blueprint.css';\nimport {AppStateContext, defaultState} from './state/globalContextState';\nimport {\n  BrowserRouter as Router,\n  Switch,\n  Route,\n} from \"react-router-dom\";\nimport Homepage from './components/Pages/Homepage/Homepage';\nimport OAuthCallbackPage from './components/Pages/OAuthCallbackPage/OAuthCallbackPage';\nimport LoadoutOptimizerPage from './components/Pages/LoadoutOptimizerPage/LoadoutOptimizerPage';\nimport {withAuth} from './components/Auth/Auth';\nimport {useAppReducer} from './hooks/useAppReducer';\nimport ErrorBoundary from './components/ErrorBoundary/ErrorBoundary';\n\nexport type TRouteItem = [string, ComponentType];\n\nexport const authRoutes : TRouteItem[] = [\n  ['/d2io/optimizer', LoadoutOptimizerPage]\n].map(([path, component]) => ([\n  path as string,\n  withAuth(component) as ComponentType\n]));\n\nexport const routes : ReactNode[] = [\n  ['/d2io', Homepage],\n  ['/d2io/auth', OAuthCallbackPage],\n  ...authRoutes\n].map(([path, component] : any) => (\n  <Route\n    key={path}\n    component={component}\n    path={path}\n    exact\n  />\n));\n\nfunction App() {\n  const [state, dispatch] = useAppReducer();\n\n  return (\n    <AppStateContext.Provider value={{state: JSON.parse(JSON.stringify(state)), dispatch}}>\n      <ErrorBoundary>\n        <Router>\n          <Switch>\n            {routes}\n          </Switch>\n        </Router>\n      </ErrorBoundary>\n    </AppStateContext.Provider>\n  );\n}\n\nexport default App;\n","import React, {useCallback, useEffect, useMemo, useState} from 'react';\nimport {css} from 'react-emotion';\nimport uniqBy from 'lodash/uniqBy';\nimport {useGlobalState} from '../../../hooks/useGlobalState';\nimport {getManifest, getProfile} from '../../../api/bungieApi';\nimport {setComponentContent, setManifest} from '../../../state/actions/manifest';\nimport {setProfile} from '../../../state/actions/profile';\nimport axios from 'axios';\nimport {FormGroup, HTMLSelect, Spinner} from '@blueprintjs/core';\nimport {CLASS_TYPE_HUNTER, CLASS_TYPE_TITAN, CLASS_TYPE_WARLOCK} from '../../../constants';\nimport {filterAndCategorize, getInventoryContent} from '../../../util/inventoryUtil';\nimport {\n  getStatBuild, presetPvEPerfect,\n  presetPvEStandard, presetPvPLowResilience,\n  presetPvPPerfect,\n  presetPvPStandard\n} from '../../../util/presetUtil';\nimport ItemDisplay from '../../ItemDisplay/ItemDisplay';\n\nexport default function LoadoutOptimizerPage() {\n  const {state, dispatch} = useGlobalState();\n  const [isLoading, setIsLoading] = useState(true);\n  const [mode, setMode] = useState('');\n  const [mainClass, setMainClass] = useState('');\n  const [exotic, setExotic] = useState('');\n\n  // // get data\n  useEffect(() => {\n    // setIsLoading(false);\n    // return;\n\n    // if there's a version, do nothings\n    if (state.manifest.version) {\n      setIsLoading(false);\n      return;\n    }\n\n    Promise.all([\n      getProfile(state.userAuth),\n      getManifest()\n    ])\n      .then(([profile, manifest]) => {\n        dispatch(setManifest({\n          contentPath: manifest.data.Response.jsonWorldComponentContentPaths.en.DestinyRecordDefinition,\n          version: manifest.data.Response.version\n        }));\n\n        dispatch(setProfile({\n          data: profile.data.Response\n        }));\n\n        return Promise.all([\n          axios({\n            url: `https://www.bungie.net${manifest.data.Response.jsonWorldComponentContentPaths.en.DestinyInventoryItemLiteDefinition}`\n          }),\n          axios({\n            url: `https://www.bungie.net${manifest.data.Response.jsonWorldComponentContentPaths.en.DestinyPowerCapDefinition}`\n          })\n        ]);\n      })\n      .then(([res, powerCapRes]) => {\n        dispatch(setComponentContent({\n          ...res.data,\n          powercaps: powerCapRes.data\n        }))\n        setIsLoading(false);\n      });\n  }, [state.userAuth, state.manifest, setIsLoading]);\n\n  const onModeChange = useCallback((e) => setMode(e.target.value), []);\n  const onMainClassChange = useCallback((e) => {\n    setMainClass(e.target.value);\n    setExotic('')\n  }, []);\n  const onExotic = useCallback((e) => setExotic(e.target.value), []);\n\n  const inventoryData = useMemo(() => {\n    if (\n      !state.profile.data\n      || !state.profile.data.profileInventory\n      || Object.keys(state.componentContent).length === 0\n    ) {\n      return [];\n    }\n\n    return getInventoryContent(\n      state.profile.data,\n      state.componentContent\n    )\n  }, [state.profile, state.componentContent]);\n\n  const categorizedItems = filterAndCategorize({\n    powerCap: 1260,\n    exoticItem: inventoryData.filter(i => i.itemHash.toString() === exotic.toString())[0] || {},\n    items: inventoryData,\n    mainClass\n  })\n\n  const exotics = uniqBy(\n    inventoryData.filter(i => i.exotic && i.classType.toString() === mainClass.toString()),\n    item => item.itemHash\n  );\n\n  const {helmets, gauntlets, chests, legs} = categorizedItems;\n\n  const combos : any[] = useMemo(() => {\n    const items : any = [];\n    let preset : any;\n\n    if (mode === 'PvP - Standard') {\n      preset = presetPvPStandard;\n    }\n\n    if (mode === 'PvP - Perfect') {\n      preset = presetPvPPerfect;\n    }\n\n    if (mode === 'PvE - Standard') {\n      preset = presetPvEStandard;\n    }\n\n    if (mode === 'PvE - Perfect') {\n      preset = presetPvEPerfect;\n    }\n\n    if (mode === 'PvP - Top Stats (Low Resilience)') {\n      preset = presetPvPLowResilience;\n    }\n\n    helmets.forEach((helmet : any) => {\n      gauntlets.forEach((gauntlet : any) => {\n        chests.forEach((chest : any) => {\n          legs.forEach((leg : any) => {\n            const set = [helmet, gauntlet, chest, leg];\n            if (preset && preset(set)) {\n              items.push(({\n                set,\n                stats: getStatBuild(set)\n              }));\n            }\n          });\n        });\n      });\n    });\n\n    return items.sort((a : any, b : any) => b.stats.total - a.stats.total);\n  }, [helmets, gauntlets, chests, legs, mode]);\n\n  if (isLoading && inventoryData.length === 0) {\n    return (\n      <div>\n        <Spinner className={css`justify-content: flex-start;`} />\n        Loading profile data...\n      </div>\n    )\n  }\n\n  return (\n    <div style={{padding: 15}}>\n      <div style={{width: 320}}>\n        <FormGroup label=\"Optimizer Presets\">\n          <HTMLSelect\n            options={[\n              '',\n              'PvP - Standard',\n              'PvP - Perfect',\n              'PvE - Standard',\n              'PvE - Perfect',\n              'PvP - Top Stats (Low Resilience)'\n            ]}\n            onChange={onModeChange}\n            value={mode}\n          />\n        </FormGroup>\n        <FormGroup label=\"Class\">\n          <HTMLSelect\n            options={[\n              {label: '', value: ''},\n              {label: 'Titan', value: CLASS_TYPE_TITAN},\n              {label: 'Hunter', value: CLASS_TYPE_HUNTER},\n              {label: 'Warlock', value: CLASS_TYPE_WARLOCK}\n            ]}\n            onChange={onMainClassChange}\n            value={mainClass}\n          />\n        </FormGroup>\n        <FormGroup label=\"Exotic\">\n          <HTMLSelect\n            options={[\n              {label: '-- No Exotic --', value: ''},\n              ...exotics.map(item => ({\n                label: item.content.displayProperties.name,\n                value: item.itemHash\n              }))\n            ]}\n            onChange={onExotic}\n            value={exotic}\n          />\n        </FormGroup>\n        <FormGroup label=\"Applied Filters\">\n          <strong>Power Cap Minimum: 1260 / High Gear Only</strong>\n        </FormGroup>\n\n        <hr />\n      </div>\n\n      <div>\n        Results: {combos.length} (only showing top 50)\n        <br />\n      </div>\n\n      {mode && combos.filter((x: any, i : number) => i < 50).map(({set, stats}, index) => (\n        <ItemDisplay\n          key={index}\n          items={set}\n          stats={stats}\n          mode={mode}\n        />\n      ))}\n    </div>\n  );\n}\n","import React from 'react';\nimport {useGlobalState} from '../../hooks/useGlobalState';\nimport {Redirect} from 'react-router';\n\nexport function withAuth(Cmp : any) {\n  return function Auth(props : any) {\n    const {state} = useGlobalState();\n\n    // if the token is expired, run refresh token call\n    const isTokenStale = state.userAuth.accessToken ? (Date.now() >= state.userAuth.expiresIn) : true;\n\n    // // if there's no access token, redirect to auth page\n    if (isTokenStale) {\n      return <Redirect to=\"/d2io\" />\n    }\n\n    return (\n      <Cmp {...props} />\n    );\n  }\n}\n","import React from 'react';\nimport {AnchorButton} from '@blueprintjs/core';\n\nexport default function Homepage() {\n  return (\n    <div>\n      <AnchorButton href=\"https://www.bungie.net/en/OAuth/Authorize?client_id=3770&response_type=code\">\n        Sync Destiny 2 Characters\n      </AnchorButton>\n    </div>\n  );\n}\n","import React, {useEffect} from 'react';\nimport qs from 'query-string';\nimport {Redirect, RouteComponentProps, useHistory} from 'react-router';\nimport {getMembershipsForCurrentUser, getAuthToken} from '../../../api/bungieApi';\nimport setUserAuth from '../../../state/actions/userToken';\nimport {useGlobalState} from '../../../hooks/useGlobalState';\n\nexport default function OAuthCallbackPage({location} : RouteComponentProps) {\n  const {dispatch, state} = useGlobalState();\n  const history = useHistory();\n\n  useEffect(() => {\n    const query : {code ?: string} = qs.parse(location.search);\n\n    if (query.code) {\n      getAuthToken(query.code || '')\n        .then((res) => {\n          const auth = setUserAuth(\n            res.data.access_token,\n            res.data.expires_in\n          );\n\n          console.log(res, auth);\n\n          return getMembershipsForCurrentUser(auth)\n            .then((membershipRes) => {\n              if (!membershipRes.data.Response.destinyMemberships[0].membershipId) {\n                throw new Error('failed to get membership id');\n              }\n\n              return dispatch(setUserAuth(\n                res.data.access_token,\n                res.data.expires_in,\n                membershipRes.data.Response.destinyMemberships[0].membershipId,\n                membershipRes.data.Response.destinyMemberships[0].membershipType\n              ));\n            });\n        });\n    }\n  }, [dispatch, location, history]);\n\n  const isTokenStale = (Date.now() > state.userAuth.expiresIn);\n\n  if (!isTokenStale && state.userAuth.membershipId) {\n    return <Redirect to=\"/d2io/optimizer\" />;\n  }\n\n  return (\n    <div>\n      authenticating...\n    </div>\n  );\n}\n","import {useReducer} from 'react';\nimport {defaultState, TActionResponse} from '../state/globalContextState';\n\nexport function useAppReducer() {\n  return useReducer((state : any, action : TActionResponse) => {\n    const {name, ...data} = action;\n\n    state[name] = data;\n\n    return JSON.parse(JSON.stringify(state));\n  }, defaultState);\n}\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}