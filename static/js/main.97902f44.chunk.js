(this["webpackJsonpdestiny-2-inventory-manager"]=this["webpackJsonpdestiny-2-inventory-manager"]||[]).push([[0],{147:function(e,t,n){e.exports=n(211)},152:function(e,t,n){},211:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(11),c=n.n(o),i=(n(152),n(89)),u=n(45),s=(n(153),n(154),n(41)),l=n(25),d=n(43);function h(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",a={name:"userAuth",accessToken:e,membershipId:n,expiresIn:Date.now()+1e3*t};if(e&&window.localStorage.setItem("userAuth",JSON.stringify(a)),!e){var r=JSON.parse(window.localStorage.getItem("userAuth")||"{}");return Object(l.a)({},a,{},r)}return a}var m=[h].reduce((function(e,t){var n=t(),a=n.name,r=Object(d.a)(n,["name"]);if(!a)throw new Error("action must return a `type` value");return Object(l.a)({},e,Object(s.a)({},a,r))}),{}),p=Object(a.createContext)(m),f=n(3),v=n(88),w=n(82);var O=n(42),b=n.n(O),g=n(53),y=n.n(g),j="https://www.bungie.net/en/OAuth/Authorize?client_id=".concat("3770","&response_type=code");function E(){return Object(a.useContext)(p)}var S=[["/d2io/optimizer",function(){return r.a.createElement("div",null,"loadout optimizer page")}]].map((function(e){var t,n=Object(u.a)(e,2),a=n[0],o=n[1];return[a,(t=o,function(e){var n=E().state;return!n.userAuth.accessToken||Date.now()>=n.userAuth.expiresIn?(window.location.href=j,r.a.createElement("div",null)):r.a.createElement(t,e)})]})),k=[["/d2io",function(){return r.a.createElement("div",null,r.a.createElement(w.AnchorButton,{href:"https://www.bungie.net/en/OAuth/Authorize?client_id=3770&response_type=code"},"Sync Destiny 2 Characters"))}],["/d2io/auth",function(e){var t=e.location,n=E().dispatch,o=Object(f.f)();return Object(a.useEffect)((function(){var e=b.a.parse(t.search);e.code&&function(e){return y()({method:"POST",headers:Object(l.a)({},{"x-api-key":"f5a851a085ec464e8c1af199031b6aec"},{"content-type":"application/x-www-form-urlencoded"}),data:b.a.stringify({code:e,grant_type:"authorization_code",client_id:"3770"}),url:(t="/app/oauth/token/","https://www.bungie.net/platform"+t)});var t}(e.code||"").then((function(e){n(h(e.data.access_token,e.data.expires_in,e.data.membership_id)),o.push("/d2io/optimizer")}))}),[n,t,o]),r.a.createElement("div",null,"authenticating...")}]].concat(Object(i.a)(S)).map((function(e){var t=Object(u.a)(e,2),n=t[0],a=t[1];return r.a.createElement(f.a,{key:n,component:a,path:n,exact:!0})}));var A=function(){var e=Object(a.useReducer)((function(e,t){var n=t.name,a=Object(d.a)(t,["name"]);return e[n]=a,JSON.parse(JSON.stringify(e))}),m),t=Object(u.a)(e,2),n=t[0],o=t[1];return r.a.createElement(p.Provider,{value:{state:JSON.parse(JSON.stringify(n)),dispatch:o}},r.a.createElement(v.a,null,r.a.createElement(f.c,null,k)))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(A,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[147,1,2]]]);
//# sourceMappingURL=main.97902f44.chunk.js.map